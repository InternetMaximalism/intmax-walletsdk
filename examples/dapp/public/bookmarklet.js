"use strict";(()=>{var G=Object.create;var I=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var X=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var B=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of V(e))!Y.call(t,s)&&s!==n&&I(t,s,{get:()=>e[s],enumerable:!(r=J(e,s))||r.enumerable});return t};var K=(t,e,n)=>(n=t!=null?G(X(t)):{},B(e||!t||!t.__esModule?I(n,"default",{value:t,enumerable:!0}):n,t));var D=z((Tt,L)=>{"use strict";var at=Object.prototype.hasOwnProperty,m="~";function x(){}Object.create&&(x.prototype=Object.create(null),new x().__proto__||(m=!1));function ct(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function k(t,e,n,r,s){if(typeof n!="function")throw new TypeError("The listener must be a function");var a=new ct(n,r||t,s),i=m?m+e:e;return t._events[i]?t._events[i].fn?t._events[i]=[t._events[i],a]:t._events[i].push(a):(t._events[i]=a,t._eventsCount++),t}function S(t,e){--t._eventsCount===0?t._events=new x:delete t._events[e]}function h(){this._events=new x,this._eventsCount=0}h.prototype.eventNames=function(){var e=[],n,r;if(this._eventsCount===0)return e;for(r in n=this._events)at.call(n,r)&&e.push(m?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};h.prototype.listeners=function(e){var n=m?m+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,a=r.length,i=new Array(a);s<a;s++)i[s]=r[s].fn;return i};h.prototype.listenerCount=function(e){var n=m?m+e:e,r=this._events[n];return r?r.fn?1:r.length:0};h.prototype.emit=function(e,n,r,s,a,i){var c=m?m+e:e;if(!this._events[c])return!1;var o=this._events[c],u=arguments.length,w,l;if(o.fn){switch(o.once&&this.removeListener(e,o.fn,void 0,!0),u){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,n),!0;case 3:return o.fn.call(o.context,n,r),!0;case 4:return o.fn.call(o.context,n,r,s),!0;case 5:return o.fn.call(o.context,n,r,s,a),!0;case 6:return o.fn.call(o.context,n,r,s,a,i),!0}for(l=1,w=new Array(u-1);l<u;l++)w[l-1]=arguments[l];o.fn.apply(o.context,w)}else{var y=o.length,f;for(l=0;l<y;l++)switch(o[l].once&&this.removeListener(e,o[l].fn,void 0,!0),u){case 1:o[l].fn.call(o[l].context);break;case 2:o[l].fn.call(o[l].context,n);break;case 3:o[l].fn.call(o[l].context,n,r);break;case 4:o[l].fn.call(o[l].context,n,r,s);break;default:if(!w)for(f=1,w=new Array(u-1);f<u;f++)w[f-1]=arguments[f];o[l].fn.apply(o[l].context,w)}}return!0};h.prototype.on=function(e,n,r){return k(this,e,n,r,!1)};h.prototype.once=function(e,n,r){return k(this,e,n,r,!0)};h.prototype.removeListener=function(e,n,r,s){var a=m?m+e:e;if(!this._events[a])return this;if(!n)return S(this,a),this;var i=this._events[a];if(i.fn)i.fn===n&&(!s||i.once)&&(!r||i.context===r)&&S(this,a);else{for(var c=0,o=[],u=i.length;c<u;c++)(i[c].fn!==n||s&&!i[c].once||r&&i[c].context!==r)&&o.push(i[c]);o.length?this._events[a]=o.length===1?o[0]:o:S(this,a)}return this};h.prototype.removeAllListeners=function(e){var n;return e?(n=m?m+e:e,this._events[n]&&S(this,n)):(this._events=new x,this._eventsCount=0),this};h.prototype.off=h.prototype.removeListener;h.prototype.addListener=h.prototype.on;h.prefixed=m;h.EventEmitter=h;typeof L<"u"&&(L.exports=h)});function E(t){if(!t)throw new Error("Invariant failed")}var C=()=>{let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=s,e=r}),reject:t,resolve:e}};var Q=600,Z=400,tt=1e3,et=100,nt=100,rt=t=>{let{url:e,name:n,window:r}=t.wallet,s=r?.height||Q,a=r?.width||Z,[i,c]=[window.screenY,window.screenX+window.innerWidth-a],o=window.open(e,n,`top=${i}px, left=${c}px, height=${s}px, width=${a}px`);if(!o)throw new Error("Failed to open window");return o},ot=t=>{let{promise:e,resolve:n}=C(),r=setInterval(()=>{(!t.window||t.window.closed)&&(clearInterval(r),n())},nt);return e},st=(t,e,n)=>{E(t.window);let{promise:r,resolve:s}=C(),a=!1,i=()=>{a||(a=!0,t.window?.postMessage({...n,id:t.id},new URL(e.wallet.url).origin))};t.handshake&&i();let c=u=>{u.source===t.window&&(u.data.method==="webmax_handshake"&&(t.handshake=u.data.result,i()),u.data.id===n.id&&(s(u.data),window.removeEventListener("message",c)))};window.addEventListener("message",c);let o=ot(t).then(()=>({id:n.id,method:n.method,namespace:n.namespace,windowHandling:"close",error:{code:-32e3,message:"Window closed"}}));return Promise.race([r,o])};var T=async(t,e,n)=>{let{promise:r,resolve:s}=C(),a=Promise.allSettled(t.calls||[]);t.id=t.id?t.id+1:1,t.calls=[...t.calls||[],r],await a,t.window&&await new Promise(o=>setTimeout(o,tt)),(t.window?.closed||!t.window)&&(t.window=rt(e));let i={...n,id:t.id},c=await st(t,e,i);return t.calls=t.calls?.filter(o=>o!==r),setTimeout(()=>{t.calls?.length!==0||c?.windowHandling!=="close"||(t.window?.close(),t.window=void 0,t.handshake=void 0)},et),s(),c};var it={supportedNamespaces:[],supportedChains:[],accounts:{eip155:[]},currentChains:{eip155:null}},R=t=>{let e=async()=>await t.get("webmax")??it;return{getState:e,setState:async r=>{let s=await e(),a=typeof r=="function"?r(s):r;await t.set("webmax",a)}}},W=t=>({supportedChains:t.supportedChains.map(n=>n.split(":")).filter(n=>n[0]==="eip155").map(n=>Number(n[1])),chainId:t.currentChains.eip155?Number(t.currentChains.eip155):null,accounts:t.accounts.eip155}),N=t=>({getState:async()=>{let e=await t.getState();return W(e)},setState:async e=>{let n=await t.getState().then(W),r=typeof e=="function"?e(n):e;return t.setState(s=>({...s,accounts:{...s.accounts,eip155:r.accounts},currentChains:{...s.currentChains,eip155:r.chainId?String(r.chainId):null}}))}}),O=()=>{let t=new Map;return{get:e=>t.get(e)??null,set:(e,n)=>{t.set(e,n)},remove:e=>{t.delete(e)}}};var g=class extends Error{constructor(e,n){super(e),this.code=n}};var b=t=>{if("error"in t)throw console.error(t.error),new g(t.error.message,t.error.code);return t.result},P=t=>{let e=0;return(n,r)=>{let s=e++;return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:s,method:n,params:r})}).then(a=>a.json()).then(b)}};var q=t=>{let{storage:e=O(),providers:n}=t,r={},s=R(e),a=async(i,c)=>{let{method:o,params:u,chainId:w}=c,y={namespace:w?`${i}:${w}`:i,method:o,params:u,metadata:t.metadata},f=await T(r,t,y);return b(f)};return{connect:async()=>{let i=await a("webmax",{method:"webmax_connect",params:[]});return await s.setState(c=>({...c,...i})),i},provider:async i=>{let[c]=i.split(":"),o=n?.[c];if(!o)throw new Error(`Provider for namespace "${c}" not found`);return await o({namespace:i,callWallet:u=>a(c,u),store:s})}}};var H=K(D(),1);var U=H.default;var j=t=>{let[e,n]=t.split(":");return{ns:e,chainId:n}};var lt=["eth_sign","eth_sendTransaction","eth_signTransaction","eth_signTypedData_v4","personal_sign","wallet_addEthereumChain","wallet_watchAsset"],$=t=>async({store:e,callWallet:n,namespace:r})=>{let s=N(e),{chainId:a}=j(r),i=await s.getState(),c=new U,o=new Map,u=i.accounts.length>0,w=Number(a??i.chainId??i.supportedChains[0]??"1"),l=async p=>{let{method:d,params:_}=p;return n({method:d,params:_,chainId:w.toString()})},y=p=>{if(!o.has(p)){if(!t?.httpRpcUrls?.[p])throw new g("HTTP RPC not provided for chain",4001);let d=P(t.httpRpcUrls[p]);o.set(p,d)}return o.get(p)},f=()=>`0x${Number(w).toString(16)}`,M=async p=>{if(t?.lockChainId)throw new g("Chain ID is locked",4001);w=p,await s.setState(d=>({...d,chainId:p})),c.emit("chainChanged",p)},F=async p=>{let{accounts:d}=await s.getState();d.join(",")!==p.join(",")&&(await s.setState(A=>({...A,accounts:p})),c.emit("accountsChanged",p),!u&&(u=!0,c.emit("connect",{chainId:f()})))};return{request:async p=>{let{method:d,params:_}=p;if(d==="eth_chainId")return f();if(d==="eth_accounts")return(await s.getState()).accounts;if(d==="wallet_switchEthereumChain"){let[{chainId:v}]=_;return await M(Number(v)),null}if(d==="eth_requestAccounts"){if(u)return(await s.getState()).accounts;let v=await l({method:"eth_requestAccounts",params:[]});return await F(v),v}if(lt.includes(d)){let v=await l({method:d,params:_});return c.emit("message",{type:"eth_subscription",data:v}),v}return await y(w)(d,_)},on:(p,d)=>c.on(p,d),removeListener:(p,d)=>c.removeListener(p,d)}};var ut="#WALLET_URL#",pt=()=>{let t=document.title,e=document.querySelector('meta[name="description"]')?.getAttribute("content")||"",n=Array.from(document.querySelectorAll('link[rel="icon"]')).map(r=>r.getAttribute("href")).filter(r=>r!==null).map(r=>new URL(r,location.href).href);return{name:t,description:e,icons:n}},dt=async()=>{alert("Webmax Injected");let e=await q({wallet:{name:"webmax",url:ut},metadata:pt(),providers:{eip155:$({httpRpcUrls:{1:"https://mainnet.infura.io/v3",5:"https://goerli.infura.io/v3",10:"https://mainnet.optimism.io",137:"https://rpc-mainnet.maticvigil.com/"}})}}).provider("eip155");window.ethereum.request=n=>{let r=e.request(n);return console.log("Request",n,r),r},window.ethereum.on=(n,r)=>(console.log("On",n),e.on(n,r))};dt();})();
